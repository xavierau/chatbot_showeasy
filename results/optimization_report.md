
# PreGuardrails GEPA Optimization Report

**Generated:** 2025-10-20 13:30:40

## Configuration
- **Student Model (Production):** gpt-4.1-nano
- **Teacher Model (Reflection):** gpt-4.1-mini
- **Optimizer:** GEPA (auto="light")
- **Optimization Time:** 1302.28 seconds

## Dataset
- **Training:** 77 examples
- **Validation:** 26 examples
- **Test:** 26 examples

## Results Summary

### Overall Metrics

| Metric | Baseline | Optimized | Improvement |
|--------|----------|-----------|-------------|
| Accuracy | 92.31% | 100.00% | +7.7% |
| Precision | 100.00% | 100.00% | +0.0% |
| Recall | 77.78% | 100.00% | +22.2% |
| F1 Score | 87.50% | 100.00% | +12.5% |
| False Positive Rate | 22.22% | 0.00% | +22.2% |
| Avg Latency (ms) | 2119.96 | 2347.76 | +227.80 |

### Key Achievements
- **Accuracy:** ✗ Below ≥10% improvement target
- **False Positive Rate:** ✓ Meets <5% target
- **Latency:** ✗ Exceeds <200ms target
- **Statistical Significance:** ✗ Not significant (p=0.1613)

## Deployment Recommendations

1. **Model Location:** `src/app/optimized/InputGuardrails/current.json`
2. **Integration:** The `PreGuardrails.load_optimized_model()` method will automatically load this model
3. **Monitoring:** Track false positive rate in production to ensure <5% threshold
4. **Re-optimization:** Consider re-running with auto="heavy" for further improvements

## Cost-Benefit Analysis
- **One-time optimization cost:** 21.7 minutes of computation
- **Ongoing benefit:** 7.7% fewer guardrail failures
- **User experience:** 22.2% fewer false rejections

---
*Generated by GEPA_for_preguardrail.ipynb*
